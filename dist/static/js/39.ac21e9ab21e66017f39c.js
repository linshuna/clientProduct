webpackJsonp([39],{"4d2u":function(t,i){},"i3/E":function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=s("mvHQ"),a=s.n(e),n=s("Q50t"),o=s("VsUZ"),r=s("I9qK"),p=s("MfrR"),c=s("kK2N"),h={mixins:[n.b],name:"NowAppoint",data:function(){return{clientvid:"",shopId:"",bannerList:[],appointMsg:{},startDate:new Date,date:"",popupVisible:!1,slots:[],typeData:[],timeData:[],time:"",title:"到店时间",popupVisibleType:!1,initData:null,currentType:1,serverName:"",myCarList:[],popupVisibleCar:null,name:"",phone:"",project:[],carvid:"",carNo:"",remark:""}},components:{"right-mt-popup":p.a,"appoint-public":c.a},created:function(){var t=this.$store.getters.getStorage;this.clientvid=t?t.vid:0;var i=this.$route.params.shopId;this.shopId=i,this.init(i),this.initTypeData(i),this.initCarList()},watch:{date:function(t,i){this.initDateData(t)},$route:function(t,i){console.log(t)}},methods:{init:function(t){var i=this;Object(o._21)({shop_id:t}).then(function(t){i.appointMsg=t,i.bannerList=t.images})},initCarList:function(){var t=this;this.clientvid&&Object(o.i)({clientvid:this.clientvid}).then(function(i){i&&i.map(function(i,s){t.myCarList.push({name:i.carNo,value:i.carvid})})})},initDateData:function(t){var i=this;Object(o._10)({day:t,shop_id:this.shopId}).then(function(t){t&&t.map(function(t,s){i.timeData.push({type:2,name:t.start,isNoOrder:0!=t.place,active:!1})})})},initTypeData:function(t){var i=this;Object(o._17)({shop_id:t}).then(function(t){t&&t.map(function(t,s){i.typeData.push({type:1,name:t.name,id:t.id,active:!1})})})},openMap:function(t,i,s,e){this.map(t,i,s,e)},showPicker:function(){this.$refs.picker.open()},handleChange:function(t){var i=t.toString();i=Object(r.a)(i,"yyyy-MM-dd"),this.date=i,console.log(t)},changeData:function(t,i){if(this.title=t,2==i&&!this.date)return this.$store.commit("showToast","请选择预约日期"),!1;this.initData=1==i?this.typeData:this.timeData,this.currentType=i,this.popupVisibleType=!0},gainData:function(t){var i=this;if(console.log(t),1==this.currentType){var s="";t.map(function(t,e){t.active&&(i.project.push({id:t.id,name:t.name}),s+=t.name+"，")}),this.serverName=s.substring(0,s.length-1),console.log(this.project)}else this.time=t.name},cancle:function(){this.popupVisibleCar=!1},select:function(){this.popupVisibleCar=!1;var t=this.$refs.pickerObj.getValues()[0];this.carvid=t.value,this.carNo=t.name,console.log(t)},showCarPicker:function(){this.popupVisibleCar=!0,this.slots=[{defaultIndex:0,flex:1,values:this.myCarList,textAlign:"center"}]},maxFont:function(){this.remark=this.remark.substring(0,200)},gainReqData:function(t){console.log(t),this.carvid=t.carvid,this.carNo=t.carNo,this.orderDay=t.orderDay,this.date=t.date,this.time=t.time,this.project=t.project,this.name=t.name,this.phone=t.phone,this.remark=t.remark},order:function(){var t=this;if(!this.clientvid)return this.$store.commit("showToast","请登录"),this.$store.commit("delay",{url:"/Login",$router:this.$router}),!1;if(!this.project||0==this.project.length)return this.$store.commit("showToast","请选择项目"),!1;if(!this.date)return this.$store.commit("showToast","请选择预约日期"),!1;if(!this.time)return this.$store.commit("showToast","请选择预约时间"),!1;if(!this.carvid||!this.carNo)return this.$store.commit("showToast","请选择服务车辆"),!1;if(!this.name)return this.$store.commit("showToast","请输入用户姓名"),!1;if(!this.phone)return this.$store.commit("showToast","请输入用户电话"),!1;if(/^1[3|5|8]\d{9}$/.test(this.phone)){var i={carvid:this.carvid,clientvid:this.clientvid,orderDay:this.date+" "+this.time,phone:this.phone,remark:this.remark,project:this.project,appname:this.name,name:this.name,shop_id:this.shopId};Object(o._15)({lists:a()(i)}).then(function(i){i&&!i.errorCode&&(t.$store.commit("showToast","预约成功"),t.$store.commit("delay",{url:"/UserCenter/MyAppointment",$router:t.$router}))})}else this.$store.commit("showToast","请输入正确的联系电话")}}},l={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"nowappoint-wrap mask"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.appointMsg,expression:"appointMsg"}],staticClass:"wallet"},[e("div",{staticClass:"nav"},[t.bannerList?e("div",{staticClass:"swiper-wrapper"},[e("mt-swipe",{attrs:{auto:4e3}},t._l(t.bannerList,function(t,i){return e("mt-swipe-item",{key:i},[e("img",{staticClass:"swiper-img",attrs:{src:t,alt:"门店图片"}})])}))],1):t._e(),t._v(" "),e("div",{staticClass:"nav_center"},[e("p",[e("span",[t._v("店名：")]),t._v(" "),e("span",[t._v(t._s(t.appointMsg.name))])]),t._v(" "),e("div",{staticClass:"star-box"},[e("span",{staticClass:"assess"},[t._v("评价：")]),t._v(" "),e("score-lv",{attrs:{stars:t.appointMsg.evaluateShow-0}})],1)])]),t._v(" "),e("div",{staticClass:"section"},[e("div",{staticClass:"section_top"},[e("div",{staticClass:"section_top_left"},[e("img",{staticClass:"section_top_img",attrs:{src:s("TGhw")}}),t._v(" "),e("p",{staticClass:"section_top_left_ptop"},[t._v(t._s(t.appointMsg.city)+t._s(t.appointMsg.dist))]),t._v(" "),e("p",[t._v(t._s(t.appointMsg.address))])]),t._v(" "),e("div",{staticClass:"section_top_right",on:{click:function(i){i.stopPropagation(),t.openMap(t.appointMsg.longitude,t.appointMsg.latitude,t.appointMsg.name,t.appointMsg.address)}}},[t._m(0)])])])]),t._v(" "),e("div",{staticClass:"footer"},[e("appoint-public",{attrs:{servertype:"1",myCarList:t.myCarList,shopId:t.shopId,typeData:t.typeData},on:{gainReqData:t.gainReqData}}),t._v(" "),e("div",{staticClass:"btn-wrap"},[e("router-link",{attrs:{to:"/"}},[e("p",[e("img",{attrs:{src:s("fCXZ")}})]),t._v(" "),e("p",[t._v("首页")])]),t._v(" "),e("a",{attrs:{href:"tel:"+t.appointMsg.phone}},[t._m(1),t._v(" "),e("p",[t._v("咨询")])]),t._v(" "),e("button",{staticClass:"appoint_btn",on:{click:t.order}},[t._v("立即预约")])],1)],1),t._v(" "),e("mt-datetime-picker",{ref:"picker",attrs:{type:"date",startDate:t.startDate,"year-format":"{value} 年","month-format":"{value} 月","date-format":"{value} 日"},on:{confirm:t.handleChange}}),t._v(" "),e("mt-popup",{attrs:{position:"bottom"},model:{value:t.popupVisibleCar,callback:function(i){t.popupVisibleCar=i},expression:"popupVisibleCar"}},[e("div",{staticClass:"picker-toolbar name-picker-toolbar"},[e("span",{staticClass:"mint-datetime-cancel",on:{click:t.cancle}},[t._v("取消")]),t._v(" "),e("span",{staticClass:"mint-datetime-confirm",on:{click:t.select}},[t._v("确定")])]),t._v(" "),e("mt-picker",{ref:"pickerObj",staticClass:"name-picker",attrs:{slots:t.slots,valueKey:"name"}})],1),t._v(" "),e("right-mt-popup",{attrs:{currentType:t.currentType,title:t.title,showData:t.initData,popupVisible:t.popupVisibleType},on:{"update:popupVisible":function(i){t.popupVisibleType=i},gainData:t.gainData}})],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"section_top_right_img"},[i("div",{staticClass:"line"}),this._v(" "),i("img",{staticClass:"section_top_right_img_img",attrs:{src:s("Egld"),alt:""}}),this._v(" "),i("p",[this._v("导航")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("p",[i("img",{attrs:{src:s("5pO8")}})])}]},m=s("VU/8")(h,l,!1,function(t){s("4d2u")},"data-v-3d878560",null);i.default=m.exports}});